{"version":3,"file":"index.vue.mjs","sources":["../../../../pages/index.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"settings\">\n      <button @click=\"toggleShowCode\" class=\"icon-button\" :title=\"showCode ? 'Hide Code' : 'Show Code'\">\n        <svg v-if=\"showCode\" class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M12,4.5C17,4.5 21.27,7.61 23,12C21.27,16.39 17,19.5 12,19.5C7,19.5 2.73,16.39 1,12C2.73,7.61 7,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C15.76,17.5 19.17,15.36 20.82,12C19.17,8.64 15.76,6.5 12,6.5C8.24,6.5 4.83,8.64 3.18,12Z\" />\n        </svg>\n        <svg v-else class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z\" />\n        </svg>\n        <transition name=\"title-fade\">\n          <span v-if=\"currentTitle\" class=\"current-title\">{{ currentTitle }}</span>\n        </transition>\n      </button>\n      <button @click=\"handleEvaluateBinary\" class=\"icon-button\" title=\"Evaluate Binary (Ctrl+Enter)\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M8,5.14V19.14L19,12.14L8,5.14Z\" />\n        </svg>\n        <span class=\"f-subscript\">F</span>\n      </button>\n      <button @click=\"handleEvaluateTS\" class=\"icon-button\" title=\"Evaluate TS (Alt+Enter)\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M8,5.14V19.14L19,12.14L8,5.14Z\" />\n        </svg>\n        <span class=\"ts-subscript\">TS</span>\n      </button>\n      <button @click=\"handleClear\" class=\"icon-button\" title=\"Clear Editor (Ctrl+H)\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,21V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z\" />\n        </svg>\n      </button>\n      <button @click=\"handleRandomPrompt\" class=\"icon-button\" title=\"Random Prompt\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M14.83,13.41L13.42,14.82L16.55,17.95L14.5,20H20V14.5L17.96,16.54L14.83,13.41M14.5,4L16.54,6.04L4,18.59L5.41,20L17.96,7.46L20,9.5V4M10.59,9.17L5.41,4L4,5.41L9.17,10.58L10.59,9.17Z\" />\n        </svg>\n      </button>\n      <button @click=\"showHelp = true\" class=\"icon-button\" title=\"Help\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z\" />\n        </svg>\n      </button>\n      <button @click=\"toggleStorageMenu\" class=\"icon-button\" title=\"Storage Menu (Ctrl+M)\">\n        <svg class=\"icon\" viewBox=\"0 0 24 24\">\n          <path fill=\"currentColor\" d=\"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\" />\n        </svg>\n      </button>\n    </div>\n    <div class=\"content-wrapper\" v-if=\"showCode\">\n      <div class=\"editor-container\">\n        <div class=\"score-editor\" :style=\"{ flex: scoreEditorFlex }\">\n          <AceEditor ref=\"scoreEditorRef\" mode=\"editor\" :value=\"defaultScore\" @evaluate=\"handleEvaluateBinary\" @evaluateTS=\"handleEvaluateTS\" @keydown=\"handleKeyDown\" />\n          <div class=\"mini-oscilloscopes\">\n            <div v-for=\"(table, index) in functionTables\" :key=\"index\" class=\"mini-oscilloscope\">\n              <div class=\"mini-oscilloscope-label\">F{{ table.functionNum }}</div>\n              <canvas :ref=\"el => { if (el) canvasRefs[table.functionNum] = el }\" width=\"80\" height=\"50\" class=\"mini-oscilloscope-canvas\"></canvas>\n            </div>\n          </div>\n        </div>\n        <div class=\"divider\" @mousedown=\"startDrag\"></div>\n        <div class=\"console-editor\" :style=\"{ flex: consoleEditorFlex }\">\n          <div class=\"console-header\">\n            <button class=\"clear-btn\" @click=\"clearConsole\" title=\"Clear console\">üóëÔ∏è</button>\n          </div>\n          <AceEditor ref=\"consoleEditorRef\" mode=\"terminal\" />\n        </div>\n      </div>\n    </div>\n    <Transition enter-active-class=\"fadeIn\" leave-active-class=\"fadeOut\" :duration=\"3000\" mode=\"out-in\">\n      <div v-if=\"plotImage\" class=\"plot-display\" :key=\"transitionKey\">\n        <img :src=\"`data:image/png;base64,${plotImage}`\" alt=\"Plot\" @click=\"showLightbox = true\" class=\"plot-image\" />\n      </div>\n    </Transition>\n    <Transition enter-active-class=\"fadeIn\" leave-active-class=\"fadeOut\" :duration=\"300\">\n      <div v-if=\"showLightbox\" class=\"lightbox\" @click=\"showLightbox = false\">\n        <button class=\"close-button\" @click.stop=\"showLightbox = false\">\n          <svg class=\"icon\" viewBox=\"0 0 24 24\">\n            <path fill=\"currentColor\" d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" />\n          </svg>\n        </button>\n        <img :src=\"`data:image/png;base64,${plotImage}`\" alt=\"Plot\" class=\"lightbox-image\" @click.stop />\n      </div>\n    </Transition>\n    <div v-if=\"showStorageMenu\" class=\"storage-menu\" @click.self=\"toggleStorageMenu\">\n      <div class=\"storage-menu-content\">\n        <div class=\"left-panel\">\n          <div class=\"entry-fields\">\n            <form @submit.prevent=\"addCode\">\n              <input v-model=\"formFields.title\" placeholder=\"Title\" required />\n              <input type=\"number\" v-model.number=\"formFields.year\" placeholder=\"Year\" required />\n              <input v-model=\"formFields.composer\" placeholder=\"Composer\" required />\n              <textarea v-model=\"formFields.comments\" placeholder=\"Comments\" rows=\"3\" required></textarea>\n              <button type=\"submit\">[ Add ]</button>\n            </form>\n          </div>\n          <div class=\"code-list\">\n            <div v-for=\"(codeEntry, index) in codes\" :key=\"index\" \n                 :class=\"{ 'selected': selectedCodeIndex === index }\" \n                 @click=\"selectCode(index)\">\n              {{ codeEntry.composer }} - {{ codeEntry.year }} - {{ codeEntry.title || 'Untitled' }}\n            </div>\n          </div>\n        </div>\n        <div class=\"right-panel\">\n          <AceEditor ref=\"codeEditorRef\" mode=\"editor\" :value=\"selectedCode ? selectedCode.code : ''\" @input=\"updateCodeContent\" />\n          <div class=\"code-actions\">\n            <button @click=\"handleEvaluateTSFromMenu\">[ Play TS ]</button>\n            <button @click=\"sendToEditor\">[ To Editor ]</button>\n            <button @click=\"updateCode(selectedCodeIndex)\">[ Update ]</button>\n            <button @click=\"deleteCode(selectedCodeIndex)\">[ Delete ]</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"footer\">\n      <div v-if=\"loading\" class=\"loading\">Processing...</div>\n      <button v-if=\"isMobileOrTablet\" @click=\"handleEvaluateTS\" class=\"mobile-evaluate-btn\" title=\"Alt+Enter\">Evaluate TS</button>\n    </div>\n    <div v-if=\"error\" class=\"error\">{{ error }}</div>\n    <HelpModal v-model=\"showHelp\" />\n  </div>\n</template>\n\n\n<script setup>\nimport { ref, onMounted, onUnmounted, nextTick, reactive, watch } from 'vue';\nimport AceEditor from '~/components/AceEditor.vue';\nimport HelpModal from '~/components/HelpModal.vue';\nimport { useRandomPrompt } from '~/composables/useRandomPrompt';\nimport { useFavicon } from '~/composables/useFavicon';\nimport { MusicV } from '~/lib/musicV';\n\n// Simple logger implementation\nconst logger = {\n  debug: (context, message, ...args) => {\n    if (debugMode && debugMode.value) {\n      console.debug(`[${context}]`, message, ...args);\n    }\n  },\n  info: (context, message, ...args) => {\n    console.info(`[${context}]`, message, ...args);\n  },\n  warn: (context, message, ...args) => {\n    console.warn(`[${context}]`, message, ...args);\n  },\n  error: (context, message, ...args) => {\n    console.error(`[${context}]`, message, ...args);\n  }\n};\n\nconst musicV = new MusicV();\nconst defaultScore = `\nINS 0 1 ;\nOSC P5 P6 B2 F2 P30;\nOUT B2 B1;\nEND;\nGEN 0 1 2 0 0 .999 50 .999 205 -.999 306 -.999 461 0 511;\nNOT 0 1 .50 125 8.45;\nNOT .75 1 .17 250 8.45;\nNOT 4.00 2 .50 500 8.46;\nTER 8.00 ;\n`;\n\nconst { startProcessing, completeProcessing } = useFavicon();\nconst scoreEditorRef = ref(null);\nconst consoleEditorRef = ref(null);\nconst codeEditorRef = ref(null);\nconst loading = ref(false);\nconst progress = ref(0);\nconst error = ref(null);\nconst plotImage = ref(null);\nconst showCode = ref(true);\nconst showHelp = ref(false);\nconst showStorageMenu = ref(false);\nconst transitionKey = ref(0);\nconst isMobileOrTablet = ref(false);\nconst showLightbox = ref(false);\nconst audioUrl = ref(null);\nconst functionTables = ref([]);\nconst canvasRefs = reactive({});\nconst currentTitle = ref(''); // For title display\nconst debugMode = ref(false); // Debug mode flag\n\nconst codes = ref([]);\nconst newCode = ref({ title: '', year: new Date().getFullYear(), composer: '', comments: '', code: '' });\nconst selectedCodeIndex = ref(-1);\nconst selectedCode = ref(null);\nconst formFields = ref({ ...newCode.value });\n\nconst isDragging = ref(false);\nconst scoreEditorFlex = ref(0.85);\nconst consoleEditorFlex = ref(0.15);\nconst startY = ref(0);\nconst startScoreEditorFlex = ref(0);\nconst startConsoleEditorFlex = ref(0);\n\nconst checkDevice = () => {\n  isMobileOrTablet.value = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n};\n\nconst loadCodes = async () => {\n  const response = await $fetch('/api/codes');\n  codes.value = response.map(entry => ({\n    ...entry,\n    title: entry.title || entry.code.split('\\n')[0].substring(0, 20) + (entry.code.split('\\n')[0].length > 20 ? '...' : '') || 'Untitled'\n  })) || [];\n};\n\nonMounted(async () => {\n  checkDevice();\n  window.addEventListener('resize', checkDevice);\n  window.addEventListener('keydown', handleKeyDownGlobal);\n  await nextTick();\n  clearConsole();\n  await loadCodes();\n});\n\nonUnmounted(() => {\n  window.removeEventListener('resize', checkDevice);\n  window.removeEventListener('keydown', handleKeyDownGlobal);\n  if (audioUrl.value) URL.revokeObjectURL(audioUrl.value);\n});\n\nconst handleKeyDownGlobal = (event) => {\n  if (event.altKey && event.shiftKey) {\n    if (event.key === 'ArrowLeft' && codes.value.length > 0) {\n      event.preventDefault();\n      navigateCodes(-1);\n    } else if (event.key === 'ArrowRight' && codes.value.length > 0) {\n      event.preventDefault();\n      navigateCodes(1);\n    }\n  }\n  handleKeyDown(event);\n};\n\nconst navigateCodes = (direction) => {\n  if (codes.value.length === 0) return;\n  let newIndex = selectedCodeIndex.value + direction;\n  if (newIndex < 0) newIndex = codes.value.length - 1; // Wrap to end\n  if (newIndex >= codes.value.length) newIndex = 0; // Wrap to start\n  selectedCodeIndex.value = newIndex;\n  selectedCode.value = codes.value[newIndex];\n  \n  // Update editor based on menu state\n  if (showStorageMenu.value && codeEditorRef.value) {\n    codeEditorRef.value.addToEditor(selectedCode.value.code || '');\n  } else {\n    scoreEditorRef.value?.addToEditor(selectedCode.value.code || '');\n  }\n  \n  // Show title with fade\n  currentTitle.value = selectedCode.value.title || 'Untitled';\n  setTimeout(() => { currentTitle.value = ''; }, 4000); // Clear after 4s\n};\n\nconst handleClear = () => scoreEditorRef.value?.clearEditor();\nconst toggleShowCode = () => showCode.value = !showCode.value;\nconst toggleStorageMenu = () => showStorageMenu.value = !showStorageMenu.value;\n\nconst handleRandomPrompt = async () => {\n  const { getRandomPrompt } = useRandomPrompt();\n  const prompt = await getRandomPrompt();\n  scoreEditorRef.value?.addToEditor(prompt);\n};\n\nconst startProgress = () => {\n  progress.value = 0;\n  const interval = setInterval(() => {\n    if (progress.value < 90) progress.value += Math.random() * 15;\n    if (progress.value > 90) progress.value = 90;\n  }, 1200);\n  return () => clearInterval(interval);\n};\n\nconst handleEvaluateBinary = () => {\n  const text = scoreEditorRef.value?.aceEditor()?.getValue();\n  if (!text?.trim()) {\n    error.value = \"Please enter some text to evaluate.\";\n    return;\n  }\n  loading.value = true;\n  startProcessing();\n  consoleEditorRef.value?.addTerminalOutput(\"musicV fortran binaries original render next\");\n  loading.value = false;\n  completeProcessing();\n};\n\n\nconst handleEvaluateTS = async (text = null) => {\n  const evalText = text ?? scoreEditorRef.value?.aceEditor()?.getValue();\n  if (!evalText || typeof evalText !== 'string' || !evalText.trim()) {\n    error.value = \"Please enter some text to evaluate.\";\n    return;\n  }\n  loading.value = true;\n  startProcessing();\n  const stopProgress = startProgress();\n  try {\n    consoleEditorRef.value?.addTerminalOutput('');\n    \n    // Reset MusicV instance\n    resetMusicV();\n    \n    // Clear oscilloscopes\n    clearOscilloscopes();\n    \n    // Force DOM update to ensure old oscilloscopes are removed\n    await nextTick();\n    \n    // Parse the score\n    musicV.value.parseScore(evalText);\n    consoleEditorRef.value?.addTerminalOutput(musicV.value.getConsoleOutput());\n    \n    // Initialize audio and play\n    await musicV.value.initAudio();\n    await musicV.value.play();\n    \n    // Generate sound\n    const audioBuffer = await musicV.value.generateSound(10);\n    const wavBlob = createWavBlob(audioBuffer, 44100);\n    audioUrl.value = URL.createObjectURL(wavBlob);\n    consoleEditorRef.value?.addTerminalOutput(`Audio generated: ${audioUrl.value}`);\n    \n    // Update function tables - this will trigger the watcher to create new oscilloscopes\n    const newTables = musicV.value.getFunctionTables();\n    if (debugMode.value) {\n      logger.debug('App', `Found ${newTables.length} function tables`);\n    }\n    functionTables.value = newTables;\n  } catch (err) {\n    consoleEditorRef.value?.addTerminalOutput(`Error: ${err.message}`);\n  } finally {\n    stopProgress();\n    loading.value = false;\n    completeProcessing();\n  }\n};\n\nwatch(functionTables, (newTables) => {\n  // Clear all canvases first\n  Object.keys(canvasRefs).forEach(key => {\n    const canvas = canvasRefs[key];\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n  });\n  \n  // Only keep references to current tables\n  const currentTableNums = newTables.map(table => table.functionNum);\n  Object.keys(canvasRefs).forEach(key => {\n    if (!currentTableNums.includes(parseInt(key))) {\n      delete canvasRefs[key];\n    }\n  });\n  \n  // Draw only current tables\n  if (debugMode.value) {\n    logger.debug('App', `Drawing ${newTables.length} oscilloscopes`);\n  }\n  \n  setTimeout(() => newTables.forEach(drawOscilloscope), 0);\n}, { deep: true });\n\nconst handleEvaluateTSFromMenu = () => {\n  if (selectedCode.value) handleEvaluateTS(selectedCode.value.code);\n};\n\nconst handleKeyDown = (event) => {\n  if (event.altKey && event.key === 'Enter') {\n    event.preventDefault();\n    handleEvaluateTS();\n  } else if (event.ctrlKey && event.key === 'Enter') {\n    event.preventDefault();\n    handleEvaluateBinary();\n  } else if (event.ctrlKey && event.key === 'h') {\n    event.preventDefault();\n    handleClear();\n  }\n};\n\nconst resetMusicV = () => {\n  // Create a new MusicV instance to clear all internal state\n  musicV.value = new MusicV();\n  \n  // If debug mode is enabled, log this action\n  if (debugMode && debugMode.value) {\n    console.debug('Reset MusicV instance');\n  }\n};\n\nconst createWavBlob = (audioData, sampleRate) => {\n  const bufferLength = audioData.length * 2;\n  const buffer = new ArrayBuffer(44 + bufferLength);\n  const view = new DataView(buffer);\n  const writeString = (offset, string) => {\n    for (let i = 0; i < string.length; i++) view.setUint8(offset + i, string.charCodeAt(i));\n  };\n  writeString(0, 'RIFF');\n  view.setUint32(4, 36 + bufferLength, true);\n  writeString(8, 'WAVE');\n  writeString(12, 'fmt ');\n  view.setUint32(16, 16, true);\n  view.setUint16(20, 1, true);\n  view.setUint16(22, 1, true);\n  view.setUint32(24, sampleRate, true);\n  view.setUint32(28, sampleRate * 2, true);\n  view.setUint16(32, 2, true);\n  view.setUint16(34, 16, true);\n  writeString(36, 'data');\n  view.setUint32(40, bufferLength, true);\n  const masterGain = 0.1;\n  let index = 44;\n  for (let i = 0; i < audioData.length; i++) {\n    const sample = Math.max(-1, Math.min(1, audioData[i] * masterGain));\n    const int16Sample = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;\n    view.setInt16(index, int16Sample, true);\n    index += 2;\n  }\n  return new Blob([buffer], { type: 'audio/wav' });\n};\n\nconst startDrag = (event) => {\n  isDragging.value = true;\n  startY.value = event.clientY;\n  startScoreEditorFlex.value = scoreEditorFlex.value;\n  startConsoleEditorFlex.value = consoleEditorFlex.value;\n  document.addEventListener('mousemove', onDrag);\n  document.addEventListener('mouseup', stopDrag);\n  document.body.style.userSelect = 'none';\n};\n\nconst onDrag = (event) => {\n  if (!isDragging.value) return;\n  const container = document.querySelector('.editor-container');\n  if (!container) return;\n  const containerHeight = container.clientHeight;\n  const deltaY = event.clientY - startY.value;\n  const deltaRatio = deltaY / containerHeight;\n  let newScoreEditorFlex = startScoreEditorFlex.value + deltaRatio;\n  let newConsoleEditorFlex = startConsoleEditorFlex.value - deltaRatio;\n  const minFlex = 0.1;\n  if (newScoreEditorFlex < minFlex) {\n    newScoreEditorFlex = minFlex;\n    newConsoleEditorFlex = 1 - minFlex;\n  } else if (newConsoleEditorFlex < minFlex) {\n    newConsoleEditorFlex = minFlex;\n    newScoreEditorFlex = 1 - minFlex;\n  }\n  scoreEditorFlex.value = newScoreEditorFlex;\n  consoleEditorFlex.value = newConsoleEditorFlex;\n};\n\nconst stopDrag = () => {\n  isDragging.value = false;\n  document.removeEventListener('mousemove', onDrag);\n  document.removeEventListener('mouseup', stopDrag);\n  document.body.style.userSelect = '';\n  nextTick(() => {\n    scoreEditorRef.value?.resize();\n    consoleEditorRef.value?.resize();\n  });\n};\n\nconst clearConsole = () => {\n  consoleEditorRef.value?.addTerminalOutput('MUSIC V SCORE PROCESSING\\n=======================\\nReady to evaluate.');\n};\n\nconst addCode = () => {\n  codes.value.push({ ...formFields.value });\n  formFields.value = { title: '', year: new Date().getFullYear(), composer: '', comments: '', code: '' };\n  selectedCodeIndex.value = codes.value.length - 1;\n  selectedCode.value = codes.value[selectedCodeIndex.value];\n  if (codeEditorRef.value) codeEditorRef.value.addToEditor('');\n};\n\nconst updateCode = async (index) => {\n  if (index >= 0 && selectedCode.value) {\n    const editorContent = codeEditorRef.value?.aceEditor()?.getValue() || '';\n    codes.value[index] = { ...formFields.value, code: editorContent };\n    await saveCodes();\n  }\n};\n\nconst deleteCode = async (index) => {\n  if (index >= 0 && confirm('Delete this code?')) {\n    codes.value.splice(index, 1);\n    selectedCodeIndex.value = -1;\n    selectedCode.value = null;\n    formFields.value = { ...newCode.value };\n    if (codeEditorRef.value) codeEditorRef.value.addToEditor('');\n    await saveCodes();\n  }\n};\n\nconst saveCodes = async () => {\n  await $fetch('/api/codes', { method: 'POST', body: codes.value });\n};\n\nconst selectCode = (index) => {\n  selectedCodeIndex.value = index;\n  selectedCode.value = codes.value[index];\n  formFields.value = { ...selectedCode.value };\n  const codeEditor = codeEditorRef.value?.aceEditor();\n  if (codeEditor) codeEditor.setValue(selectedCode.value.code || '', -1);\n};\n\nconst updateCodeContent = (value) => {\n  if (selectedCode.value) {\n    selectedCode.value.code = value;\n    formFields.value.code = value;\n  }\n};\n\nconst sendToEditor = () => {\n  if (selectedCode.value) {\n    scoreEditorRef.value?.addToEditor(selectedCode.value.code || '');\n    toggleStorageMenu();\n    clearOscilloscopes();\n  }\n};\n\nconst drawOscilloscope = (table) => {\n  // Validate table data\n  if (!table || !table.functionNum || !table.data || table.data.length === 0) {\n    if (debugMode.value) {\n      logger.warn('Oscilloscope', `Invalid function table data for F${table?.functionNum || 'unknown'}`);\n    }\n    return;\n  }\n\n  // Get canvas for this function table\n  const canvas = canvasRefs[table.functionNum];\n  if (!canvas) {\n    if (debugMode.value) {\n      logger.warn('Oscilloscope', `Canvas not found for function table F${table.functionNum}`);\n    }\n    return;\n  }\n  \n  // Get 2D context\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    if (debugMode.value) {\n      logger.warn('Oscilloscope', `Could not get 2D context for canvas F${table.functionNum}`);\n    }\n    return;\n  }\n  \n  if (debugMode.value) {\n    logger.debug('Oscilloscope', `Drawing function table F${table.functionNum} with ${table.data.length} points`);\n  }\n  \n  const width = canvas.width;\n  const height = canvas.height;\n  const data = table.data;\n  \n  // Clear canvas\n  ctx.clearRect(0, 0, width, height);\n  ctx.fillStyle = '#1a1a1a';\n  ctx.fillRect(0, 0, width, height);\n  \n  // Draw grid\n  ctx.strokeStyle = '#333333';\n  ctx.lineWidth = 0.5;\n  for (let x = 0; x <= width; x += width / 4) {\n    ctx.beginPath();\n    ctx.moveTo(x, 0);\n    ctx.lineTo(x, height);\n    ctx.stroke();\n  }\n  for (let y = 0; y <= height; y += height / 2) {\n    ctx.beginPath();\n    ctx.moveTo(0, y);\n    ctx.lineTo(width, y);\n    ctx.stroke();\n  }\n  \n  // Draw center line\n  ctx.strokeStyle = '#555555';\n  ctx.beginPath();\n  ctx.moveTo(0, height / 2);\n  ctx.lineTo(width, height / 2);\n  ctx.stroke();\n  \n  // Find min/max values\n  let minVal = Infinity, maxVal = -Infinity;\n  for (let i = 0; i < data.length; i++) {\n    minVal = Math.min(minVal, data[i]);\n    maxVal = Math.max(maxVal, data[i]);\n  }\n  \n  // Ensure we have a range even if all values are the same\n  if (minVal === maxVal) { \n    minVal -= 0.5; \n    maxVal += 0.5; \n  }\n  \n  // Draw waveform\n  ctx.strokeStyle = '#00ff00';\n  ctx.lineWidth = 1.5;\n  ctx.beginPath();\n  const dataLength = data.length;\n  \n  try {\n    for (let i = 0; i < dataLength; i++) {\n      const x = (i / (dataLength - 1)) * width;\n      const normalizedValue = (data[i] - minVal) / (maxVal - minVal);\n      const y = (1 - normalizedValue) * height;\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    }\n    ctx.stroke();\n    \n    // Add labels\n    ctx.fillStyle = '#00ff00';\n    ctx.font = '9px monospace';\n    ctx.fillText(`${maxVal.toFixed(2)}`, 2, 8);\n    ctx.fillText(`${minVal.toFixed(2)}`, 2, height - 2);\n    ctx.fillText(`${dataLength}p`, width - 25, 8);\n  } catch (err) {\n    if (debugMode.value) {\n      logger.error('Oscilloscope', `Error drawing oscilloscope for F${table.functionNum}:`, err);\n    }\n  }\n};\n\nconst clearOscilloscopes = () => {\n  // Clear all canvas elements\n  Object.keys(canvasRefs).forEach(key => {\n    const canvas = canvasRefs[key];\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n  });\n  \n  // Clear all canvas references\n  Object.keys(canvasRefs).forEach(key => {\n    delete canvasRefs[key];\n  });\n  \n  // Clear function tables\n  functionTables.value = [];\n  \n  if (debugMode.value) {\n    logger.debug('App', 'Cleared all oscilloscopes');\n  }\n};\n</script>\n\n<style scoped>\n/* Reset to eliminate white borders */\n:deep(html), :deep(body) {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n  width: 100%;\n  background: #000 !important;\n  color: #ffffff;\n  overflow: hidden;\n  font-family: 'Web437_IBM_MDA', monospace;\n}\n\n.app-container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  width: 100vw;\n  position: fixed; /* Fix white borders */\n  top: 0;\n  left: 0;\n  background: #000 !important;\n  color: #ffffff;\n  overflow: hidden;\n}\n\n.current-title {\n  position: absolute;\n  right: 100%; /* Left of eye toggle */\n  top: 50%;\n  transform: translateY(-50%);\n  margin-right: 10px; /* Space from eye */\n  color: #ffffff;\n  opacity: 0.5;\n  font-family: 'Web437_IBM_MDA', monospace;\n  font-size: 14px;\n  pointer-events: none;\n  white-space: nowrap;\n}\n\n.title-fade-enter-active,\n.title-fade-leave-active {\n  transition: opacity 1s ease-in-out;\n}\n\n.title-fade-enter-from,\n.title-fade-leave-to {\n  opacity: 0;\n}\n\n.title-fade-enter-to {\n  opacity: 0.5;\n}\n\n.title-fade-leave-from {\n  opacity: 0.5;\n}\n\n@keyframes titleFadeOut {\n  0% { opacity: 0.5; }\n  75% { opacity: 0.5; } /* Hold until 3s */\n  100% { opacity: 0; } /* Fade out 3-4s */\n}\n\n.title-fade-leave-active {\n  animation: titleFadeOut 4s ease-in-out forwards;\n}\n\n.content-wrapper {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding-top: 60px;\n  padding-bottom: 60px;\n  background: #000; /* Ensure no white gaps */\n}\n\n.editor-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: transparent;\n}\n\n.score-editor, .console-editor {\n  position: relative;\n  min-height: 50px;\n}\n\n.console-editor {\n  background: #000;\n  border-top: 1px solid #333;\n}\n\n.console-header {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  z-index: 10;\n}\n\n.clear-btn {\n  background: transparent;\n  color: #ffffff;\n  border: none;\n  border-radius: 4px;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.clear-btn:hover { background: #555; }\n\n.divider {\n  height: 5px;\n  background: #333;\n  cursor: row-resize;\n}\n\n.divider:hover { background: #555; }\n.divider:active { background: #777; }\n\n.mini-oscilloscopes {\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  z-index: 10;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n}\n\n.mini-oscilloscope {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.7);\n  border-radius: 3px;\n  padding: 2px;\n}\n\n.mini-oscilloscope-label {\n  font-family: 'Web437_IBM_MDA', monospace;\n  color: #00ff00;\n  font-size: 8px;\n  margin-bottom: 2px;\n}\n\n.mini-oscilloscope-canvas {\n  border: 1px solid #444;\n  border-radius: 2px;\n}\n\n.settings {\n  position: fixed;\n  top: 10px;\n  right: 20px;\n  z-index: 100;\n  display: flex;\n  gap: 8px;\n}\n\n.icon-button {\n  position: relative;\n  background: transparent;\n  border: none;\n  color: #ffffff;\n  padding: 8px;\n  cursor: pointer;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.icon-button:hover { background: rgba(255, 255, 255, 0.1); }\n\n.ts-subscript {\n  position: absolute;\n  bottom: 2px;\n  right: 2px;\n  font-size: 10px;\n  color: #00ff00;\n}\n\n.f-subscript {\n  position: absolute;\n  bottom: 2px;\n  right: 2px;\n  font-size: 10px;\n  color: #4a148c; /* Dark violet color */\n}\n\n.icon { width: 24px; height: 24px; }\n\n.plot-display { text-align: center; }\n\n.plot-image {\n  cursor: pointer;\n  transition: transform 0.3s;\n}\n\n.plot-image:hover { transform: scale(1.02); }\n\n.lightbox {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: rgba(0, 0, 0, 0.9);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000;\n}\n\n.lightbox-image {\n  max-width: 80vw;\n  max-height: 80vh;\n  object-fit: contain;\n}\n\n.close-button {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  background: transparent;\n  border: none;\n  color: #ffffff;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 50%;\n}\n\n.close-button:hover { background: rgba(255, 255, 255, 0.1); }\n\n.storage-menu {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: rgba(0, 0, 0, 0.8);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1500;\n}\n\n.storage-menu-content {\n  width: 80%;\n  height: 80%;\n  display: flex;\n  background: #1e1e1e;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.left-panel {\n  width: 40%;\n  display: flex;\n  flex-direction: column;\n  background: #252526;\n}\n\n.entry-fields {\n  flex: 1;\n  padding: 10px;\n  border-bottom: 1px solid #333;\n}\n\n.entry-fields input,\n.entry-fields textarea {\n  width: 100%;\n  margin-bottom: 5px;\n  padding: 5px;\n  background: #3c3c3c;\n  border: 1px solid #555;\n  color: #ffffff;\n  font-family: 'Web437_IBM_MDA', monospace;\n  resize: vertical;\n}\n\n.entry-fields button {\n  width: 100%;\n  padding: 5px;\n  background: #444;\n  border: 1px solid #ffffff;\n  color: #ffffff;\n  cursor: pointer;\n  font-family: 'Web437_IBM_MDA', monospace;\n}\n\n.entry-fields button:hover { background: #555; }\n\n.code-list {\n  flex: 2;\n  overflow-y: auto;\n  padding: 10px;\n  color: #d4d4d4;\n  font-family: 'Web437_IBM_MDA', monospace;\n  font-size: 12px;\n}\n\n.code-list div {\n  padding: 5px;\n  cursor: pointer;\n  border-bottom: 1px solid #333;\n}\n\n.code-list div:hover { background: #3c3c3c; }\n.code-list div.selected { background: #555; color: #ffffff; }\n\n.right-panel {\n  width: 60%;\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n}\n\n.code-actions {\n  display: flex;\n  gap: 5px;\n  padding: 10px 0;\n}\n\n.code-actions button {\n  flex: 1;\n  padding: 5px;\n  background: #444;\n  border: 1px solid #ffffff;\n  color: #ffffff;\n  cursor: pointer;\n  font-family: 'Web437_IBM_MDA', monospace;\n}\n\n.code-actions button:hover { background: #555; }\n\n.footer {\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 1rem;\n  gap: 1rem;\n  background: #000 !important;\n  z-index: 1000;\n}\n\n.loading { margin-right: auto; }\n\n.mobile-evaluate-btn {\n  background: #4caf50;\n  color: #ffffff;\n  border: none;\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.mobile-evaluate-btn:hover { background: #45a049; }\n.mobile-evaluate-btn:active { background: #3d8b40; transform: translateY(1px); }\n\n.error {\n  position: fixed;\n  bottom: 60px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #ff5252;\n  color: #ffffff;\n  padding: 8px 16px;\n  border-radius: 4px;\n  z-index: 1000;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes fadeOut {\n  from { opacity: 1; }\n  to { opacity: 0; }\n}\n\n.fadeIn { animation: fadeIn 2s ease-in-out; animation-fill-mode: both; }\n.fadeOut { animation: fadeOut 3s ease-in-out; animation-fill-mode: both; }\n\n::selection {\n  background: #2d2d2d;\n  color: #ffffff;\n}\n</style>"],"names":["index"],"mappings":"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"}